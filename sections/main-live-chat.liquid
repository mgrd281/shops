<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div class="section page-width-content color-{{ section.settings.color_scheme }}">
  <div
    class="
      spacing-style
      layout-panel-flex
      layout-panel-flex--column
      section-content-wrapper
      mobile-column
    "
    style="
      --gap: 24px;
      padding-top: {{ section.settings.padding-block-start }}px;
      padding-bottom: {{ section.settings.padding-block-end }}px;
    "
  >
    <div class="rte" style="max-width: 700px; margin: 0 auto; width: 100%;">
      <h1 style="text-align: center; margin-bottom: 3rem; text-transform: capitalize; font-weight: 700; letter-spacing: -0.5px;">{{ page.title }}</h1>
      
      {{ page.content }}
      
      <div class="live-chat-card">
        <div class="chat-icon-wrapper">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#2e7d32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
          </svg>
        </div>
        
        <h3>Live-Chat Support</h3>
        <p>Haben Sie Fragen zu unseren Produkten oder Ihrer Bestellung? Unser Support-Team ist für Sie da. Schreiben Sie uns einfach eine Nachricht.</p>
        
        <button id="start-chat-btn" class="chat-button">
          <span class="btn-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
          </span>
          Chat starten
        </button>
        
        <div class="support-hours">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          Mo.–So. 09:00–23:00 Uhr
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .live-chat-card {
    margin-top: 3rem;
    padding: 3rem;
    background: #ffffff;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 10px 40px rgba(0,0,0,0.06);
    border: 1px solid rgba(0,0,0,0.04);
    transition: transform 0.3s ease;
  }
  
  .live-chat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 50px rgba(0,0,0,0.08);
  }

  .chat-icon-wrapper {
    width: 80px;
    height: 80px;
    background: #f0fdf4;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
  }

  .live-chat-card h3 {
    margin: 0 0 1rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: #1a1a1a;
  }

  .live-chat-card p {
    margin: 0 auto 2rem;
    color: #666;
    line-height: 1.6;
    max-width: 450px;
    font-size: 1rem;
  }

  .chat-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 14px 32px;
    background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%);
    color: white;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(46, 125, 50, 0.2);
  }

  .chat-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
    opacity: 0.95;
  }

  .support-hours {
    margin-top: 1.5rem;
    font-size: 0.85rem;
    color: #888;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }
  
  @media (max-width: 768px) {
    .live-chat-card {
      padding: 2rem 1.5rem;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const chatBtn = document.getElementById('start-chat-btn');
    
    if (chatBtn) {
      chatBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Try to open various common chat widgets
        let chatOpened = false;

        // 1. Shopify Inbox / Shopify Chat
        if (window.ShopifyChat) {
            window.ShopifyChat.show();
            chatOpened = true;
        }
        
        // 2. Tidio
        else if (window.tidioChatApi) {
            window.tidioChatApi.open();
            chatOpened = true;
        }
        
        // 3. Tawk.to
        else if (window.Tawk_API) {
            window.Tawk_API.maximize();
            chatOpened = true;
        }
        
        // 4. Gorgias
        else if (window.GorgiasChat) {
            window.GorgiasChat.open();
            chatOpened = true;
        }
        
        // 5. Zendesk
        else if (window.zE) {
            window.zE.activate();
            chatOpened = true;
        }
        
        // 6. WhatsApp Fallback (if configured)
        else {
             // Fallback: Check if there is a WhatsApp link in the footer and click it, or alert
             const whatsappLink = document.querySelector('a[href*="wa.me"]');
             if(whatsappLink) {
                 window.open(whatsappLink.href, '_blank');
                 chatOpened = true;
             }
        }

        if (!chatOpened) {
            alert('Der Live-Chat wird geladen oder ist momentan nicht verfügbar. Bitte versuchen Sie es gleich noch einmal.');
            // Optional: Reload page to force widget load
            // location.reload();
        }
      });
    }
  });
</script>

{% schema %}
{
  "name": "Live Chat Page",
  "class": "section-wrapper",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 60
    }
  ]
}
{% endschema %}
